{
  "name": "auth/multi-factor_authentication/can_be_enabled_on_a_user.json",
  "interactions": [
    {
      "request": {
        "method": "post",
        "uri": "http://localhost:1337/v1/auth/signup/email-password",
        "headers": {
          "content-type": "application/json; charset=utf-8"
        },
        "body": {
          "encoding": "utf-8",
          "string": "{\"email\":\"user-1@nhost.io\",\"password\":\"password-1\"}"
        }
      },
      "response": {
        "status": 200,
        "headers": {
          "surrogate-control": "no-store",
          "cache-control": "no-store, no-cache, must-revalidate, proxy-revalidate",
          "x-dns-prefetch-control": "off",
          "date": "Mon, 07 Feb 2022 02:31:21 GMT",
          "access-control-allow-origin": "*",
          "strict-transport-security": "max-age=15552000; includeSubDomains",
          "content-type": "application/json; charset=utf-8",
          "pragma": "no-cache",
          "x-xss-protection": "1; mode=block",
          "content-length": "913",
          "x-download-options": "noopen",
          "etag": "W/\"391-mrNqfQIQCXwaLiLmn7XQrXI0XwU\"",
          "x-frame-options": "SAMEORIGIN",
          "x-content-type-options": "nosniff",
          "expires": "0"
        },
        "body": {
          "encoding": "utf-8",
          "string": "{\"session\":{\"accessToken\":\"eyJhbGciOiJIUzI1NiJ9.eyJodHRwczovL2hhc3VyYS5pby9qd3QvY2xhaW1zIjp7IngtaGFzdXJhLWFsbG93ZWQtcm9sZXMiOlsidXNlciIsIm1lIl0sIngtaGFzdXJhLWRlZmF1bHQtcm9sZSI6InVzZXIiLCJ4LWhhc3VyYS11c2VyLWlkIjoiZjhkZjc3MjItMzVlNC00YjkxLTg3NzctYTkwNmM1ODc0MTdjIiwieC1oYXN1cmEtdXNlci1pc0Fub255bW91cyI6ImZhbHNlIn0sInN1YiI6ImY4ZGY3NzIyLTM1ZTQtNGI5MS04Nzc3LWE5MDZjNTg3NDE3YyIsImlzcyI6Imhhc3VyYS1hdXRoIiwiaWF0IjoxNjQ0MjAxMDgxLCJleHAiOjE2NDQyMDE5ODF9.VVV0GSmNw8F_ulklC593xiaVhC363viXllN67_vny4I\",\"accessTokenExpiresIn\":900,\"refreshToken\":\"d63a4b62-e38f-4dd7-b080-8cf493cb1768\",\"user\":{\"id\":\"f8df7722-35e4-4b91-8777-a906c587417c\",\"createdAt\":\"2022-02-07T02:31:21.625771+00:00\",\"displayName\":\"user-1@nhost.io\",\"avatarUrl\":\"https://s.gravatar.com/avatar/d86c12c3233e91ec90869a1f874cdf0e?r=g&default=blank\",\"locale\":\"en\",\"email\":\"user-1@nhost.io\",\"isAnonymous\":false,\"defaultRole\":\"user\",\"roles\":[\"user\",\"me\"]}},\"mfa\":null}"
        }
      }
    },
    {
      "request": {
        "method": "get",
        "uri": "http://localhost:1337/v1/auth/mfa/totp/generate",
        "headers": {
          "authorization": "Bearer eyJhbGciOiJIUzI1NiJ9.eyJodHRwczovL2hhc3VyYS5pby9qd3QvY2xhaW1zIjp7IngtaGFzdXJhLWFsbG93ZWQtcm9sZXMiOlsidXNlciIsIm1lIl0sIngtaGFzdXJhLWRlZmF1bHQtcm9sZSI6InVzZXIiLCJ4LWhhc3VyYS11c2VyLWlkIjoiZjhkZjc3MjItMzVlNC00YjkxLTg3NzctYTkwNmM1ODc0MTdjIiwieC1oYXN1cmEtdXNlci1pc0Fub255bW91cyI6ImZhbHNlIn0sInN1YiI6ImY4ZGY3NzIyLTM1ZTQtNGI5MS04Nzc3LWE5MDZjNTg3NDE3YyIsImlzcyI6Imhhc3VyYS1hdXRoIiwiaWF0IjoxNjQ0MjAxMDgxLCJleHAiOjE2NDQyMDE5ODF9.VVV0GSmNw8F_ulklC593xiaVhC363viXllN67_vny4I"
        },
        "body": null
      },
      "response": {
        "status": 200,
        "headers": {
          "surrogate-control": "no-store",
          "cache-control": "no-store, no-cache, must-revalidate, proxy-revalidate",
          "x-dns-prefetch-control": "off",
          "date": "Mon, 07 Feb 2022 02:31:21 GMT",
          "access-control-allow-origin": "*",
          "strict-transport-security": "max-age=15552000; includeSubDomains",
          "content-type": "application/json; charset=utf-8",
          "pragma": "no-cache",
          "x-xss-protection": "1; mode=block",
          "content-length": "4265",
          "x-download-options": "noopen",
          "etag": "W/\"10a9-jpthkbTgxyORU3SD2aZPcHYYTX8\"",
          "x-frame-options": "SAMEORIGIN",
          "x-content-type-options": "nosniff",
          "expires": "0"
        },
        "body": {
          "encoding": "utf-8",
          "string": "{\"imageUrl\":\"data:image/png;base64,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\",\"totpSecret\":\"MYUV22TOJ5OXEAZU\"}"
        }
      }
    },
    {
      "request": {
        "method": "post",
        "uri": "http://localhost:1337/v1/auth/user/mfa",
        "headers": {
          "content-type": "application/json; charset=utf-8",
          "authorization": "Bearer eyJhbGciOiJIUzI1NiJ9.eyJodHRwczovL2hhc3VyYS5pby9qd3QvY2xhaW1zIjp7IngtaGFzdXJhLWFsbG93ZWQtcm9sZXMiOlsidXNlciIsIm1lIl0sIngtaGFzdXJhLWRlZmF1bHQtcm9sZSI6InVzZXIiLCJ4LWhhc3VyYS11c2VyLWlkIjoiZjhkZjc3MjItMzVlNC00YjkxLTg3NzctYTkwNmM1ODc0MTdjIiwieC1oYXN1cmEtdXNlci1pc0Fub255bW91cyI6ImZhbHNlIn0sInN1YiI6ImY4ZGY3NzIyLTM1ZTQtNGI5MS04Nzc3LWE5MDZjNTg3NDE3YyIsImlzcyI6Imhhc3VyYS1hdXRoIiwiaWF0IjoxNjQ0MjAxMDgxLCJleHAiOjE2NDQyMDE5ODF9.VVV0GSmNw8F_ulklC593xiaVhC363viXllN67_vny4I"
        },
        "body": {
          "encoding": "utf-8",
          "string": "{\"code\":\"576852\",\"activeMfaType\":\"totp\"}"
        }
      },
      "response": {
        "status": 200,
        "headers": {
          "surrogate-control": "no-store",
          "cache-control": "no-store, no-cache, must-revalidate, proxy-revalidate",
          "x-dns-prefetch-control": "off",
          "date": "Mon, 07 Feb 2022 02:31:21 GMT",
          "access-control-allow-origin": "*",
          "strict-transport-security": "max-age=15552000; includeSubDomains",
          "content-type": "text/html; charset=utf-8",
          "pragma": "no-cache",
          "x-xss-protection": "1; mode=block",
          "content-length": "2",
          "x-download-options": "noopen",
          "etag": "W/\"2-nOO9QiTIwXgNtWtBJezz8kv3SLc\"",
          "x-frame-options": "SAMEORIGIN",
          "x-content-type-options": "nosniff",
          "expires": "0"
        },
        "body": {
          "encoding": "utf-8",
          "string": "OK"
        }
      }
    }
  ]
}